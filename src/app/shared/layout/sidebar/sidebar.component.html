<!-- Sidebar Menu Desplegable -  Momentos dulces de Mariló -->
<!-- Sidebar Overlay & Panel: SIEMPRE EN EL DOM -->
<div 
  class="fixed inset-0 z-50 overflow-hidden"
  [class.pointer-events-none]="!isOpen"
  role="dialog"
  aria-modal="true"
  aria-labelledby="sidebar-title">

  <!-- Backdrop con transición -->
  <div 
    class="absolute inset-0 bg-bakery-deep/50 backdrop-blur-sm transition-opacity duration-300"
    [ngClass]="{
      'opacity-100': isOpen,
      'opacity-0': !isOpen
    }"
    (click)="onBackdropClick($event)">
  </div>

  <!-- Sidebar Panel con transición -->
  <div 
    class="fixed left-0 top-0 h-full w-80 max-w-sm transition-transform duration-300 ease-in-out z-50"
    [ngClass]="{
      'translate-x-0': isOpen,
      '-translate-x-full': !isOpen
    }"
    (click)="$event.stopPropagation()">
    
    <!-- Contenido del Sidebar -->
    <div class="flex flex-col h-full bg-gradient-to-b from-bakery-cream via-sweet-vanilla to-bakery-warm border-r border-bakery-gold/30 shadow-bakery">
      
      <!-- Header -->
      <div class="flex items-center justify-between p-6 border-b border-bakery-gold/20 bg-sweet-peach">
        <div class="flex items-center space-x-3">
          <app-logo [size]="10"/>
          <div class="flex flex-col">
            <span class="text-accent-caramel font-medium text-sm leading-none">momentos dulces de</span>
            <span class="text-bakery-deep font-elegant font-bold text-lg leading-none">Mariló</span>
          </div>
        </div>
        <button 
          type="button" 
          class="text-bakery-brown hover:text-bakery-deep transition-colors duration-200 p-2 rounded-lg hover:bg-sweet-peach/30 focus:outline-none focus:ring-2 focus:ring-accent-caramel"
          (click)="close()"
          aria-label="Cerrar menú">
          <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
      </div>

      <!-- Onda decorativa -->
      <div class="-mt-1 w-full left-0 right-0 z-10">
        <svg viewBox="0 0 1440 80" xmlns="http://www.w3.org/2000/svg" class="w-full h-16" preserveAspectRatio="none">
          <path d="M0,0 C80,35 120,15 180,45 C220,65 280,25 340,50 C400,75 450,30 520,55 C580,80 620,35 680,60 C740,85 780,40 840,65 C900,90 940,45 1000,70 C1060,95 1100,50 1160,75 C1220,100 1280,55 1340,80 C1380,95 1420,70 1440,85 L1440,0 Z" fill="#FFDAB9"/>
        </svg>
      </div>


      
      <!-- Body del Sidebar -->
      <div class="flex-1 overflow-y-auto px-0 py-6 scrollbar-thin scrollbar-thumb-bakery-gold scrollbar-track-bakery-warm">
        <nav class="space-y-2">
          
          <!-- Sección: Navegación Principal -->
          <div class="px-6 mb-4">
            <h3 i18n="@@menuTitleNavigation" class="text-xs font-semibold text-bakery-brown uppercase tracking-wider mb-3 font-elegant">
              Navegación
            </h3>
            <div class="space-y-1">
              @for (option of menuOptions; track option.label) {
                @if (option.label === 'public') {
                <a 
                  class="flex items-center px-3 py-2.5 text-bakery-deep hover:text-accent-caramel hover:bg-sweet-peach/30 rounded-lg transition-all duration-200 cursor-pointer group"
                  [ngClass]="{
                    'opacity-50 pointer-events-none': option.requiresAuth 
                  }"
                  (click)="navigateAndClose(option.route!)">
                  <div class="flex items-center justify-center w-8 h-8 rounded-lg text-white mr-3 bg-accent-caramel shrink-0">
                    <mat-icon *ngIf="option.icon" class="!text-base !leading-none !flex !items-center !justify-center">{{ option.icon }}</mat-icon>
                  </div>
                  <span class="font-medium">{{ option.text }}</span>
                </a>
                }}
            </div>
          </div>
          
          
          
          <!-- Sección: Gestión -->
           @if (isAdmin) {
             <!-- Divider -->
            <div class="mx-6 border-t border-bakery-gold/20"></div>
            <div class="px-6 mt-4">
              <h3 i18n="@@menuTitleManagement" class="text-xs font-semibold text-bakery-brown uppercase tracking-wider mb-3 font-elegant">
                Gestión
              </h3>
              <!-- ADMIN -->
              <div class="space-y-1">
                @for (option of menuOptions; track option.label) {
                  @if (option.label === 'admin') {
                  <a 
                    class="flex items-center px-3 py-2.5 text-bakery-deep hover:text-accent-caramel hover:bg-sweet-peach/30 rounded-lg transition-all duration-200 cursor-pointer group"
                    [ngClass]="{
                      'opacity-50 pointer-events-none': option.requiresAuth != isAdmin
                    }"
                    (click)="navigateAndClose(option.route!)">
                    <div class="flex items-center justify-center w-8 h-8 rounded-lg text-white mr-3 bg-accent-cherry shrink-0">
                      <mat-icon *ngIf="option.icon" class="!text-base !leading-none !flex !items-center !justify-center">{{ option.icon }}</mat-icon>
                    </div>
                    <span class="font-medium">{{ option.text }}</span>
                  </a>
                  }}
              </div>
            </div>
          } 

          <!-- Divider -->
          <div class="mx-6 border-t border-bakery-gold/20"></div>
          
          <!-- Sección: Información -->
          <div class="px-6 mt-4">
            <h3 i18n="@@menuTitleInformation" class="text-xs font-semibold text-bakery-brown uppercase tracking-wider mb-3 font-elegant">
              Información
            </h3>
            <!-- INFO -->
            <div class="space-y-1">
              @for (option of menuOptions; track option.label) {
                @if (option.label === 'info') {
                <a 
                  class="flex items-center px-3 py-2.5 text-bakery-deep hover:text-accent-caramel hover:bg-sweet-peach/30 rounded-lg transition-all duration-200 cursor-pointer group"
                  [ngClass]="{
                    'opacity-50 pointer-events-none': option.requiresAuth 
                  }"
                  (click)="navigateAndClose(option.route!)">
                  <div class="flex items-center justify-center w-8 h-8 rounded-lg text-white mr-3 bg-accent-chocolate shrink-0">
                    <mat-icon *ngIf="option.icon" class="!text-base !leading-none !flex !items-center !justify-center">{{ option.icon }}</mat-icon>
                  </div>
                  <span class="font-medium">{{ option.text }}</span>
                </a>
                }}
            </div>
          </div>
        </nav>
      </div>
      
      <!-- Footer del Sidebar -->
      <div class="border-t border-bakery-gold/20 bg-sweet-vanilla/50 p-4">
        <div class="flex items-center justify-center space-x-4 text-bakery-brown">
          <span class="text-bakery-warm ">© 2025 Momentos dulces de Mariló</span>
          <div class="w-1 h-1 bg-accent-caramel rounded-full"></div>
        </div>
      </div>
    </div>
  </div>
</div>
 